<div class="container">
    <p class="text-center display-4 mb-5">Plano {{planTitle}}

    <p class="text-center mt-5 mb-5 text-fixture " >Dados de Acesso </p>
<!-- remove novalidate after tests -->
    <div class="form-layout" novalidate> 
        <form [formGroup]="formGroup" (ngSubmit)="onSubmit(formGroup.value)" class="form">
            <div class="row">
                <div class="col">

                    <mat-form-field class="form-element input-size-fixture">
                        <input matInput placeholder="Nome do Usuário" formControlName="username">
                        <mat-error
                            *ngIf="!formGroup.controls['username'].valid && formGroup.controls['username'].touched">
                            {{ getErrorUsername() }}
                        </mat-error>
                    </mat-form-field>


                    <mat-form-field class="form-element">
                        <input matInput placeholder="Email" formControlName="email">
                        <mat-error *ngIf="!formGroup.controls['email'].valid && formGroup.controls['email'].touched">
                            {{ getErrorEmail() }}
                        </mat-error>
                    </mat-form-field>

                    <div class="row">
                        <div class="col">
                            <mat-form-field class="form-element">
                                <input matInput placeholder="Nome" formControlName="name">
                                <mat-error
                                    *ngIf="!formGroup.controls['name'].valid && formGroup.controls['name'].touched">
                                    {{ getErrorName() }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <div class="col">
                            <mat-form-field class="form-element">
                                <textarea matInput placeholder="Sobrenome" matTextareaAutosize matAutosizeMinRows="1"
                                    matAutosizeMaxRows="5" formControlName="surname"></textarea>
                                <mat-error *ngIf="!formGroup.controls['surname'].valid && formGroup.controls['surname'].touched">
                                    {{ getErrorName() }}
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>

                    <mat-form-field appearance="fill" class="form dropdown-fixture mb-2">
                        <mat-label>Estado</mat-label>
                        <mat-select (selectionChange)="onStateOptionChange($event)" formControlName="state">
                            <mat-option *ngFor="let state of states" [value]="state.name">
                                {{ state.name }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="!formGroup.controls['state'].valid && formGroup.controls['state'].touched">
                            {{ getErrorState() }}
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="form-element">
                        <input matInput placeholder="Senha" [type]="hide ? 'password' : 'text'"
                            formControlName="password" required>
                        <mat-icon matSuffix (click)="hide = !hide">{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
                        <mat-error
                            *ngIf="!formGroup.controls['password'].valid && formGroup.controls['password'].touched">
                            {{ getErrorPassword() }}
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="col col-ajustment">
                    <div class="col">
                        <mat-form-field class="form-element">
                            <input matInput placeholder="Telefone" formControlName="phone">
                            <mat-error
                                *ngIf="!formGroup.controls['phone'].valid && formGroup.controls['phone'].touched">
                                {{ getErrorPhoneNumber() }}
                            </mat-error>
                        </mat-form-field>
                    </div>

                    <mat-form-field class="form-element">
                        <textarea matInput placeholder="Endereço" matTextareaAutosize matAutosizeMinRows="1"
                            matAutosizeMaxRows="5" formControlName="address"></textarea>
                        <mat-error
                            *ngIf="!formGroup.controls['surname'].valid && formGroup.controls['surname'].touched">
                            Campo precisa de preenchimendo no mínimo 5 caracteres
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="fill" class="form dropdown-fixture">
                        <mat-label>Cidade</mat-label>
                        <mat-select (selectionChange)="onCityOptionChange($event)" formControlName="city">
                            <mat-option *ngFor="let city of cities"[value]="city">{{city}}</mat-option>
                        </mat-select>
                        <mat-error *ngIf="!formGroup.controls['city'].valid && formGroup.controls['city'].touched">
                            {{ getErrorCity() }}
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="form-element margin-fixture">
                        <input matInput placeholder="Confirmação" [type]="hide ? 'passwordconfirmation' : 'text2'"
                            formControlName="passwordconfirmation" required>
                        <mat-icon matSuffix (click)="hide2 = !hide2">{{hide2 ? 'visibility_off' : 'visibility'}}</mat-icon>
                        <mat-error
                            *ngIf="formGroup.controls['passwordconfirmation'].touched">
                            {{ getErrorPasswordMissmatch() }}
                        </mat-error>
                    </mat-form-field>

                </div>
            </div>
            <hr class="my-4">
            <p class="text-center mt-5 mb-5 text-fixture ">Dados do cartão </p>

            <div class="row">
                <div class="col">

                    <mat-form-field class="form-element">
                        <input matInput placeholder="Nome" formControlName="ownername">
                        <mat-error
                            *ngIf="!formGroup.controls['ownername'].valid && formGroup.controls['ownername'].touched">
                            {{ getErrorOwnerName() }}
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="fill" class="form dropdown-fixture">
                        <mat-label>Tarja do Cartão</mat-label>
                        <mat-select (selectionChange)="onCardFlagChange($event)" formControlName="cardflag">
                            <mat-option value="visa">Visa</mat-option>
                            <mat-option value="master">MasterCard</mat-option>
                            <mat-option value="elo">Elo</mat-option>
                            <mat-option value="amex">American Express</mat-option>
                        </mat-select>
                        <mat-error
                            *ngIf="!formGroup.controls['cardflag'].valid && formGroup.controls['cardflag'].touched">
                            {{ getErrorCity() }}
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="form-element">
                        <input matInput placeholder="Código de Segurança" formControlName="securitycode">
                        <mat-error
                            *ngIf="!formGroup.controls['securitycode'].valid && formGroup.controls['securitycode'].touched">
                            {{ getErrorSecurityCode() }}
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="col">

                    <mat-form-field class="form-element">
                        <input matInput placeholder="Número do Cartão" formControlName="cardnumber">
                        <mat-error
                            *ngIf="!formGroup.controls['cardnumber'].valid && formGroup.controls['cardnumber'].touched">
                            {{ getErrorCardNumber() }}
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="form-element">
                        <input matInput placeholder="Expira em" formControlName="expirationdate">
                        <mat-error
                            *ngIf="!formGroup.controls['expirationdate'].valid && formGroup.controls['expirationdate'].touched">
                            {{ getErrorExpirationDate() }}
                        </mat-error>
                    </mat-form-field>


                        <div class="text-center mt-5 ">
                            <mat-card> <span>Valor a Pagar: R$ {{price}},00</span> </mat-card>
                        </div>

                    

                </div>
            </div>
            <div class="form-element text-center mt-5">
                <button mat-raised-button color="default" type="submit" class="button btn">Confirmar</button>

                <!-- [disabled]="!formGroup.valid" -->


            </div>
            <div class="progress-group-border mt-5 mb-2">
                <div class="text-center mt-5" *ngIf="isProgressBarActivated === true">
                    <mat-progress-bar mode="indeterminate"  class="mb-2"></mat-progress-bar>
                    <span id="element" class="elementToFadeInAndOut">{{processingMessage}}</span>

                </div>

            </div>
        </form>
    </div>
</div>